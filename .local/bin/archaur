#!/usr/bin/env bash

# ###################################################
# My Generic BASH script template
#
version="1.0.1" # Sets version variable
#
# HISTORY:
#
# * 2019.06.11 - v1.0.0  - First Creation
# * 2019.06.15 - v1.0.1  - Add temp directory check in main script
#
# ###################################################

# Provide a variable with the location of this script.
scriptPath="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

############ Base Script template config ############
hasTmpDir=1

source "${scriptPath}/script-utils/setup.sh"
source "${scriptPath}/script-utils/test.sh"

# Set main script
# -----------------------------------
function mainScript() {
############## Begin Script Here ###################

if path.isNotDir "${tmpDir}"; then
  echo "temp directory not exists..."
  exit 0
fi

cd $tmpDir
case "${1}" in
  update  )
    if str.isNotEmpty "${2}" && path.isFile "${scriptPath}/_archaur/${2}"; then
      source "${scriptPath}/_archaur/${2}"
      AURDIR=$(basename ${AURURL} .git)
      git clone ${AURURL} ${AURDIR}; cd ${AURDIR}

      # complier pakeage src
      makepkg -si --needed ${PACKAGER}
    else
      echo "${2} : unknow package."
    fi
    ;;
  * ) echo "${1} : unknow action."
esac

############### End Script Here ####################
}

# ############# ############# #############
# ##       TIME TO RUN THE SCRIPT        ##
# ############# ############# #############

# Run your script
mainScript ${@}
